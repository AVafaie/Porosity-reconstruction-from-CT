# Porosity-reconstruction-from-CT
MATLAB code for digitized reconstruction of the rock porosity distribution from ‎Computed Tomography (CT) images

The code contains 3 MATLAB scripts to reconstruct and visualize grid-based porosity maps ‎for centimeter-scale rock cores. The script “Porosity_permeability_calculations.m” reads ‎binarized cross-section CT images collected consecutively along the core length. This can be ‎done using open-access softwares like ImageJ. An example stack of grayscale and binary ‎images acquired from a limestone core are provided together with the code to run it. To do the ‎calculations and project the porosity and permeability distribution onto a grid-based structure, ‎the script asks for a number of other parameters: the number and size of grid blocks for domain ‎discretization, effective rock porosity and permeability measured in the lab as well as the core ‎diameter and length. ‎
The code first correlates the pixel domain with the arbitrarily-sized grid blocks in each image ‎and then calculates the porosity for all cells. It enables shifting the average rock porosity by a ‎certain value, which can be the difference between average CT and effective rock porosities, by ‎randomly distributing pores on different CT images. This porosity shifting provides a simple ‎approach to account for the sub-CT resolution porosity. An explicit permeability-porosity ‎relationship is used to build a grid-based permeability map from that of porosity across the ‎core. Calculations are saved in .mat files for later processing and plotting. The script is written ‎in a way minimizing computational costs, in particular, in terms of the required memory to ‎handle data. Conserving the memory, the code makes processing large datasets affordable with ‎low-power computational resources.‎
The script “Plot_CT_2D.m” plots 2D grayscale images of the rock cross sections, their ‎corresponding binarized images before and after porosity modification as well as the grid-‎based distribution of porosity. The script “Plot_CT_3D.m” enables visualizing the 3D ‎distribution of porosity and permeability along the whole or slices of the rock domain. Step-‎wise comments are provided along the matlab scripts to facilitate understanding and using the ‎code. ‎
